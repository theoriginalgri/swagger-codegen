{{>licenseInfo}}
{{#models}}{{#model}}
#include "{{classname}}.h"
#include "{{classname}}_p.h"

#include <QDataStream>
#include <QCoreApplication>

{{#cppNamespaceDeclarations}}
namespace {{this}} {
{{/cppNamespaceDeclarations}}

{{classname}}::{{classname}}()
: d(new {{classname}}Data)
{
}

{{classname}}::{{classname}}(const {{classname}} &other)
: d(other.d)
{
}

{{classname}}::~{{classname}}()
{
}

{{classname}} &{{classname}}::operator =(const {{classname}} &other)
{
    d = other.d;
    return *this;
}

bool {{classname}}::operator ==(const {{classname}} &cmp) const
{
    if (d == cmp.d) {
        return true;
    }

    return (
        {{#vars}}
        d->{{getter}} == cmp.d->{{getter}}{{#hasMore}} &&{{/hasMore}}
        {{/vars}}
    );
}

QVariantMap {{classname}}::toMap(bool *ok) const
{
    if (ok) {
        *ok = true;
    }

    QVariantMap map;
    {{#vars}}
    map.insert("{{name}}", QVariant::fromValue(d->{{getter}}));
    {{/vars}}
    return map;
}

{{#vars}}
{{{datatype}}} {{classname}}::{{getter}}() const
{
    return d->{{getter}};
}

void {{classname}}::{{setter}}(const {{{datatype}}} &{{getter}})
{
    d->{{getter}} = {{getter}};
}

{{#isContainer}}
void {{classname}}::append_{{getter}}(const {{{complexType}}} &{{getter}})
{
    d->{{getter}}.append({{getter}});
}

int {{classname}}::remove_{{getter}}(const {{{complexType}}} &{{getter}})
{
    return d->{{getter}}.removeAll({{getter}});
}
{{/isContainer}}
{{/vars}}
QDataStream &operator <<(QDataStream &out, const {{classname}} &obj)
{
    out{{#vars}} << obj.{{getter}}(){{/vars}};
    
    return out;
}

QDataStream &operator >>(QDataStream &in, {{classname}} &obj)
{
    {{#vars}}
    {{{datatype}}} {{getter}};
    in >> {{getter}};
    {{/vars}}
    
    {{#vars}}
    obj.{{setter}}({{getter}});
    {{/vars}}
    
    return in;
}

QDebug operator <<(QDebug stream, const {{classname}} &obj)
{
    QDebugStateSaver saver(stream);
    stream.nospace()
        << "{{classname}} { "
        {{#vars}}
        << "{{getter}}: " << obj.{{getter}}(){{#hasMore}} << ", "{{/hasMore}}
        {{/vars}}
        << " }";

    return stream;
}

static void registerConverters()
{
    QMetaType::registerConverter(&{{classname}}::toMap);
}

Q_COREAPP_STARTUP_FUNCTION(registerConverters)

{{#cppNamespaceDeclarations}}
} // namespace {{this}}
{{/cppNamespaceDeclarations}}

{{/model}}
{{/models}}
